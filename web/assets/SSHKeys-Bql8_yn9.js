import{p as e,B as s,C as t,l as a,c as l,i,f as n,u as o,s as r,m as c,k as d,K as v,n as y,z as k,v as u,x as m,t as p,e as b,j as h,y as f,r as g,R as _,G as S,q as w,I as x,J as C,A as $,F as P}from"./svelte-C2ZEhdPX.js";import{f as A,t as R,S as H,a as F}from"./index-BZQbtzM3.js";import{a as O}from"./api-562HSYvc.js";import{C as j}from"./ConfirmModal-0Siv2-zv.js";import"./vendor-CPGM4lnp.js";var z=n('<div class="loading-state svelte-1k2522y"><div class="spinner svelte-1k2522y"></div> <p class="svelte-1k2522y">Loading...</p></div>'),D=n('<span class="btn-spinner svelte-1k2522y"></span> Connecting...',1),T=n('<div class="guest-state svelte-1k2522y"><div class="guest-icon svelte-1k2522y"><!></div> <h2 class="svelte-1k2522y">SSH Features Locked</h2> <p class="svelte-1k2522y">Sign in with PipeOps to manage your SSH configuration and\n                    enable secure access features.</p> <button class="btn btn-primary svelte-1k2522y"><!></button></div>'),q=n('<div class="empty-state svelte-1k2522y"><div class="empty-icon svelte-1k2522y"><!></div> <h2 class="svelte-1k2522y">No Remote Connections</h2> <p class="svelte-1k2522y">Add a remote server to quickly SSH into it from your Rexec\n                    terminal.</p> <button class="btn btn-primary svelte-1k2522y">+ Add Your First Connection</button></div>'),B=n("<span> </span>"),I=n('<div class="key-card svelte-1k2522y"><div class="key-icon svelte-1k2522y"><!></div> <div class="key-info svelte-1k2522y"><div class="key-name svelte-1k2522y"> </div> <div class="key-fingerprint svelte-1k2522y"> </div> <div class="key-meta svelte-1k2522y"><!> <span> </span></div></div> <div class="actions svelte-1k2522y"><button class="btn btn-secondary btn-sm svelte-1k2522y" title="Run in Terminal"><!> Run</button> <button class="btn btn-secondary btn-sm svelte-1k2522y" title="Copy SSH Command">Copy</button> <button class="btn btn-danger btn-sm svelte-1k2522y">Delete</button></div></div>'),U=n('<div class="keys-list svelte-1k2522y"></div>'),K=n('<div class="modal-overlay svelte-1k2522y" role="presentation"><div class="modal svelte-1k2522y" role="dialog" aria-modal="true"><div class="modal-header svelte-1k2522y"><h2 class="svelte-1k2522y">Add Remote Connection</h2> <button class="modal-close svelte-1k2522y">×</button></div> <div class="modal-body svelte-1k2522y"><div class="form-group svelte-1k2522y"><label for="host-name" class="svelte-1k2522y">Name</label> <input type="text" id="host-name" placeholder="e.g., Production DB" maxlength="64" class="svelte-1k2522y"/></div> <div class="form-row svelte-1k2522y"><div class="form-group svelte-1k2522y" style="flex: 2"><label for="host-address" class="svelte-1k2522y">Hostname / IP</label> <input type="text" id="host-address" placeholder="e.g., 192.168.1.10" class="svelte-1k2522y"/></div> <div class="form-group svelte-1k2522y" style="flex: 1"><label for="host-port" class="svelte-1k2522y">Port</label> <input type="number" id="host-port" placeholder="22" class="svelte-1k2522y"/></div></div> <div class="form-group svelte-1k2522y"><label for="host-user" class="svelte-1k2522y">Username</label> <input type="text" id="host-user" placeholder="root" class="svelte-1k2522y"/></div> <div class="form-group svelte-1k2522y"><label for="host-key" class="svelte-1k2522y">Identity File (Optional)</label> <input type="text" id="host-key" placeholder="e.g., ~/.ssh/id_rsa" class="svelte-1k2522y"/> <span class="form-hint svelte-1k2522y">Path to private key inside the terminal</span></div></div> <div class="modal-footer svelte-1k2522y"><button class="btn btn-secondary svelte-1k2522y">Cancel</button> <button class="btn btn-primary svelte-1k2522y"> </button></div></div></div>'),L=n('<!> <div class="ssh-keys svelte-1k2522y"><div class="ssh-keys-header svelte-1k2522y"><button class="back-btn svelte-1k2522y">← Back</button> <h1 class="svelte-1k2522y">SSH Keys</h1></div> <div class="ssh-keys-content svelte-1k2522y"><div class="section-header svelte-1k2522y"><p class="section-description svelte-1k2522y">Save remote server details to quickly connect FROM your Rexec\n                terminals.</p> <button class="btn btn-primary svelte-1k2522y"><!> Add Connection</button></div> <!></div></div> <!>',1);function G(n,w){e(w,!1);const G=()=>m(A,"$isGuest",M),[M,N]=f(),J=s();let Y=[],E=c([]),Q=c(!0),V=c(!1),W=c(""),X=c(""),Z=c(22),ee=c("root"),se=c(""),te=c(!1),ae=c(!1),le=c(!1),ie=c(null);async function ne(){if(!d(ae)){r(ae,!0);try{const e=await F.getOAuthUrl();e?window.location.href=e:(R.error("Unable to connect to PipeOps. Please try again later."),r(ae,!1))}catch(e){R.error("Failed to connect to PipeOps. Please try again."),r(ae,!1)}}}async function oe(){r(Q,!0);{const{data:e,error:s}=await O.get("/api/ssh/hosts");e?r(E,e.hosts||[]):s&&R.error("Failed to load remote hosts")}r(Q,!1)}async function re(){if(!d(W).trim()||!d(X).trim()||!d(ee).trim())return void R.error("Please fill in all required fields");r(te,!0);const{data:e,error:s}=await O.post("/api/ssh/hosts",{name:d(W).trim(),hostname:d(X).trim(),port:d(Z),username:d(ee).trim(),identity_file:d(se).trim()});e?(r(E,[e,...d(E)]),R.success("Remote host added"),de()):R.error(s||"Failed to add host"),r(te,!1)}function ce(){r(W,""),r(X,""),r(Z,22),r(ee,"root"),r(se,""),r(V,!0)}function de(){r(V,!1)}t(oe),a(()=>{},()=>{oe()}),l(),i();var ve=L(),ye=o(ve);{let e=v(()=>(d(ie),S(()=>"key"===d(ie)?.type?"SSH Key":"Remote Connection"))),s=v(()=>(d(ie),S(()=>d(ie)?`Are you sure you want to delete "${d(ie).name}"? This action cannot be undone.`:"")));j(ye,{get title(){return`Delete ${d(e)??""}`},get message(){return d(s)},confirmText:"Delete",cancelText:"Cancel",variant:"danger",get show(){return d(le)},set show(e){r(le,e)},$$events:{confirm:async function(){if(!d(ie))return;const{id:e,type:s}=d(ie);r(ie,null);let t=null;t="key"===s?(await O.delete(`/api/ssh/keys/${e}`)).error:(await O.delete(`/api/ssh/hosts/${e}`)).error;t?R.error(t||"Failed to delete "+("key"===s?"SSH key":"host")):"key"===s?(Y=Y.filter(s=>s.id!==e),R.success("SSH key deleted")):(r(E,d(E).filter(s=>s.id!==e)),R.success("Remote connection deleted"))},cancel:function(){r(ie,null)}},$$legacy:!0})}var ke=k(ye,2),ue=y(ke);y(ue).__click=()=>J("back");var me=k(ue,2),pe=y(me),be=k(y(pe),2);be.__click=ce;var he=y(be),fe=e=>{H(e,{status:"lock",size:14})};u(he,e=>{G()&&e(fe)});var ge=k(pe,2),_e=e=>{var s=z();b(e,s)},Se=e=>{var s=g(),t=o(s),a=e=>{var s=T(),t=y(s),a=y(t);H(a,{status:"lock",size:48});var l=k(t,6);l.__click=ne;var i=y(l),n=e=>{var s=D();b(e,s)},o=e=>{var s=x("Sign in with PipeOps");b(e,s)};u(i,e=>{d(ae)?e(n):e(o,!1)}),p(()=>l.disabled=d(ae)),b(e,s)},l=e=>{var s=g(),t=o(s),a=e=>{var s=q(),t=y(s),a=y(t);H(a,{status:"globe",size:48}),k(t,6).__click=ce,b(e,s)},l=e=>{var s=U();C(s,5,()=>d(E),e=>e.id,(e,s)=>{var t=I(),a=y(t),l=y(a);H(l,{status:"globe",size:24});var i=k(a,2),n=y(i),o=y(n),c=k(n,2),v=y(c),m=k(c,2),h=y(m),f=e=>{var t=B(),a=y(t);p(()=>$(a,`Identity: ${d(s),S(()=>d(s).identity_file)??""} •`)),b(e,t)};u(h,e=>{d(s),S(()=>d(s).identity_file)&&e(f)});var g=k(h,2),_=y(g),w=k(i,2),x=y(w);x.__click=()=>function(e){J("run",{command:e.ssh_command})}(d(s));var C=y(x);H(C,{status:"terminal",size:14});var P=k(x,2);P.__click=()=>function(e){navigator.clipboard.writeText(e),R.success("Command copied to clipboard")}(d(s).ssh_command),k(P,2).__click=()=>{return e=d(s).id,t=d(s).name,r(ie,{id:e,name:t,type:"host"}),void r(le,!0);var e,t},p(e=>{$(o,(d(s),S(()=>d(s).name))),$(v,`${d(s),S(()=>d(s).username)??""}@${d(s),S(()=>d(s).hostname)??""}:${d(s),S(()=>d(s).port)??""}`),$(_,`Added ${e??""}`)},[()=>(d(s),S(()=>{return e=d(s).created_at,new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"});var e}))]),b(e,t)}),b(e,s)};u(t,e=>{d(E),S(()=>0===d(E).length)?e(a):e(l,!1)},!0),b(e,s)};u(t,e=>{G()?e(a):e(l,!1)},!0),b(e,s)};u(ge,e=>{d(Q)?e(_e):e(Se,!1)});var we=k(ke,2),xe=e=>{var s=K();s.__click=de;var t=y(s);t.__click=e=>e.stopPropagation();var a=y(t);k(y(a),2).__click=de;var l=k(a,2),i=y(l),n=k(y(i),2),o=k(i,2),c=y(o),v=k(y(c),2),u=k(c,2),m=k(y(u),2),h=k(o,2),f=k(y(h),2),g=k(h,2),S=k(y(g),2),w=k(l,2),x=y(w);x.__click=de;var C=k(x,2);C.__click=re;var P=y(C);p(()=>{x.disabled=d(te),C.disabled=d(te),$(P,d(te)?"Adding...":"Add")}),_(n,()=>d(W),e=>r(W,e)),_(v,()=>d(X),e=>r(X,e)),_(m,()=>d(Z),e=>r(Z,e)),_(f,()=>d(ee),e=>r(ee,e)),_(S,()=>d(se),e=>r(se,e)),b(e,s)};u(we,e=>{d(V)&&e(xe)}),p(()=>{be.disabled=G(),P(be,"title",G()?"Sign in with PipeOps to manage SSH":"")}),b(n,ve),h(),N()}w(["click"]);export{G as default};
