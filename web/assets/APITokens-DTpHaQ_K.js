import{w as e,g as t,p as a,C as s,i as l,f as o,u as c,s as n,z as r,m as i,v,x as d,k as p,e as k,j as u,y as h,n as m,r as b,t as g,a1 as f,R as w,Y as y,J as _,V as x,q as T,_ as C,A as L,a2 as I}from"./svelte-C2ZEhdPX.js";import{a as A,t as E}from"./index-BZQbtzM3.js";import"./vendor-CPGM4lnp.js";const P="/api";const $=function(){const{subscribe:a,set:s,update:l}=e({tokens:[],loading:!1,error:null});function o(){const e=t(A);return e.token?{Authorization:`Bearer ${e.token}`}:{}}return{subscribe:a,async fetchTokens(){l(e=>({...e,loading:!0,error:null}));try{const e=await fetch(`${P}/tokens`,{headers:o()});if(!e.ok)throw new Error("Failed to fetch tokens");const t=await e.json();l(e=>({...e,tokens:t.tokens||[],loading:!1}))}catch(e){l(t=>({...t,error:e.message,loading:!1}))}},async createToken(e,t=["read","write"],a){l(e=>({...e,loading:!0,error:null}));try{const s=await fetch(`${P}/tokens`,{method:"POST",headers:{...o(),"Content-Type":"application/json"},body:JSON.stringify({name:e,scopes:t,expires_in:a})});if(!s.ok)throw new Error("Failed to create token");const l=await s.json();return await this.fetchTokens(),{token:l.token,id:l.id}}catch(s){return l(e=>({...e,error:s.message,loading:!1})),null}},async revokeToken(e){l(e=>({...e,loading:!0,error:null}));try{if(!(await fetch(`${P}/tokens/${e}`,{method:"DELETE",headers:o()})).ok)throw new Error("Failed to revoke token");return l(t=>({...t,tokens:t.tokens.filter(t=>t.id!==e),loading:!1})),!0}catch(t){return l(e=>({...e,error:t.message,loading:!1})),!1}},async deleteToken(e){l(e=>({...e,loading:!0,error:null}));try{if(!(await fetch(`${P}/tokens/${e}/permanent`,{method:"DELETE",headers:o()})).ok)throw new Error("Failed to delete token");return l(t=>({...t,tokens:t.tokens.filter(t=>t.id!==e),loading:!1})),!0}catch(t){return l(e=>({...e,error:t.message,loading:!1})),!1}},reset(){s({tokens:[],loading:!1,error:null})}}}();var M=o('<div class="loading svelte-1t9ac8e">Loading tokens...</div>'),D=o('<div class="empty-state svelte-1t9ac8e"><svg class="empty-icon svelte-1t9ac8e" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"></path></svg> <h3 class="svelte-1t9ac8e">No API tokens yet</h3> <p class="svelte-1t9ac8e">Create a token to authenticate with the rexec CLI or make API requests.</p> <button class="btn btn-primary svelte-1t9ac8e">Create your first token</button></div>'),B=o('<span class="scope-badge svelte-1t9ac8e"> </span>'),j=o('<div class="detail svelte-1t9ac8e"><span class="label svelte-1t9ac8e">Last used</span> <span class="value svelte-1t9ac8e"> </span></div>'),H=o('<div class="detail svelte-1t9ac8e"><span class="label svelte-1t9ac8e">Last used</span> <span class="value never svelte-1t9ac8e">Never</span></div>'),z=o('<div class="detail svelte-1t9ac8e"><span class="label svelte-1t9ac8e">Expires</span> <span class="value svelte-1t9ac8e"> </span></div>'),F=o('<div class="token-card svelte-1t9ac8e"><div class="token-info svelte-1t9ac8e"><div class="token-name svelte-1t9ac8e"><svg class="token-icon svelte-1t9ac8e" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"></path></svg> <span> </span></div> <div class="token-meta svelte-1t9ac8e"><span class="token-prefix svelte-1t9ac8e"> </span> <span class="token-scopes svelte-1t9ac8e"></span></div></div> <div class="token-details svelte-1t9ac8e"><div class="detail svelte-1t9ac8e"><span class="label svelte-1t9ac8e">Created</span> <span class="value svelte-1t9ac8e"> </span></div> <!> <!></div> <div class="token-actions svelte-1t9ac8e"><button class="btn btn-danger btn-sm svelte-1t9ac8e">Revoke</button></div></div>'),N=o('<div class="tokens-list svelte-1t9ac8e"></div>'),S=o('<div class="modal-overlay svelte-1t9ac8e"><div class="modal svelte-1t9ac8e"><div class="modal-header svelte-1t9ac8e"><h3 class="svelte-1t9ac8e">Create API Token</h3> <button class="close-btn svelte-1t9ac8e">Ã—</button></div> <div class="modal-body svelte-1t9ac8e"><div class="form-group svelte-1t9ac8e"><label for="token-name" class="svelte-1t9ac8e">Token Name</label> <input type="text" id="token-name" placeholder="e.g., CLI Token, CI/CD Pipeline" class="svelte-1t9ac8e"/></div> <div class="form-group svelte-1t9ac8e"><label class="svelte-1t9ac8e">Permissions</label> <div class="scope-options svelte-1t9ac8e"><label class="scope-option svelte-1t9ac8e"><input type="checkbox" class="svelte-1t9ac8e"/> <span class="scope-label svelte-1t9ac8e"><strong class="svelte-1t9ac8e">Read</strong> <small class="svelte-1t9ac8e">List containers, view status</small></span></label> <label class="scope-option svelte-1t9ac8e"><input type="checkbox" class="svelte-1t9ac8e"/> <span class="scope-label svelte-1t9ac8e"><strong class="svelte-1t9ac8e">Write</strong> <small class="svelte-1t9ac8e">Create, start, stop containers</small></span></label> <label class="scope-option svelte-1t9ac8e"><input type="checkbox" class="svelte-1t9ac8e"/> <span class="scope-label svelte-1t9ac8e"><strong class="svelte-1t9ac8e">Admin</strong> <small class="svelte-1t9ac8e">Delete containers, manage tokens</small></span></label></div></div> <div class="form-group svelte-1t9ac8e"><label for="token-expiry" class="svelte-1t9ac8e">Expiration</label> <select id="token-expiry" class="svelte-1t9ac8e"><option>No expiration</option><option>30 days</option><option>60 days</option><option>90 days</option><option>1 year</option></select></div></div> <div class="modal-footer svelte-1t9ac8e"><button class="btn btn-secondary svelte-1t9ac8e">Cancel</button> <button class="btn btn-primary svelte-1t9ac8e">Create Token</button></div></div></div>'),q=x('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-1t9ac8e"><path d="M5 13l4 4L19 7"></path></svg>'),R=x('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-1t9ac8e"><rect x="9" y="9" width="13" height="13" rx="2"></rect><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path></svg>'),Y=o('<div class="modal-overlay svelte-1t9ac8e"><div class="modal token-created-modal svelte-1t9ac8e"><div class="modal-header success svelte-1t9ac8e"><svg class="success-icon svelte-1t9ac8e" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> <h3 class="svelte-1t9ac8e">Token Created</h3></div> <div class="modal-body svelte-1t9ac8e"><p class="warning svelte-1t9ac8e"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-1t9ac8e"><path d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg> Make sure to copy your token now. You won\'t be able to see it again!</p> <div class="token-display svelte-1t9ac8e"><code class="svelte-1t9ac8e"> </code> <button class="copy-btn svelte-1t9ac8e"><!></button></div> <div class="usage-example svelte-1t9ac8e"><p class="svelte-1t9ac8e">Use this token with the CLI:</p> <code class="svelte-1t9ac8e"> </code></div></div> <div class="modal-footer svelte-1t9ac8e"><button class="btn btn-primary svelte-1t9ac8e">Done</button></div></div></div>'),J=o('<div class="api-tokens svelte-1t9ac8e"><div class="tokens-header svelte-1t9ac8e"><div class="header-content svelte-1t9ac8e"><h2 class="svelte-1t9ac8e">API Tokens</h2> <p class="description svelte-1t9ac8e">Create personal access tokens to authenticate with the CLI or API. <a href="/docs/cli" class="text-accent link-underline">Learn more about the CLI</a></p></div> <button class="btn btn-primary svelte-1t9ac8e"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-1t9ac8e"><path d="M12 5v14M5 12h14"></path></svg> New Token</button></div> <!></div> <!> <!>',1);function O(e,t){a(t,!1);const o=()=>d($,"$tokens",x),[x,T]=h();let A=i(""),P=i(""),O=i(["read","write"]),U=i(!1),V=i(""),W=i(!1),G=i(!1);async function K(){if(!p(A).trim())return void E.error("Token name is required");const e=p(P)?parseInt(p(P)):void 0,t=await $.createToken(p(A).trim(),p(O),e);t?(n(V,t.token),n(U,!1),n(W,!0),n(A,""),n(P,""),n(O,["read","write"]),E.success("API token created successfully")):E.error("Failed to create token")}function Q(){navigator.clipboard.writeText(p(V)),n(G,!0),E.success("Token copied to clipboard"),setTimeout(()=>n(G,!1),2e3)}function X(e){return new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}function Z(e){p(O).includes(e)?n(O,p(O).filter(t=>t!==e)):n(O,[...p(O),e])}s(()=>{$.fetchTokens()}),l();var ee=J(),te=c(ee),ae=m(te);r(m(ae),2).__click=()=>n(U,!0);var se=r(ae,2),le=e=>{var t=M();k(e,t)},oe=e=>{var t=b(),a=c(t),s=e=>{var t=D();r(m(t),6).__click=()=>n(U,!0),k(e,t)},l=e=>{var t=N();_(t,5,()=>o().tokens,e=>e.id,(e,t)=>{var a=F(),s=m(a),l=m(s),o=r(m(l),2),c=m(o),n=r(l,2),i=m(n),d=m(i),u=r(i,2);_(u,5,()=>p(t).scopes,C,(e,t)=>{var a=B(),s=m(a);g(()=>L(s,p(t))),k(e,a)});var h=r(s,2),b=m(h),f=r(m(b),2),w=m(f),y=r(b,2),x=e=>{var a=j(),s=r(m(a),2),l=m(s);g(e=>L(l,e),[()=>function(e){const t=new Date(e),a=(new Date).getTime()-t.getTime(),s=Math.floor(a/864e5);return 0===s?"Today":1===s?"Yesterday":s<30?`${s} days ago`:X(e)}(p(t).last_used_at)]),k(e,a)},T=e=>{var t=H();k(e,t)};v(y,e=>{p(t).last_used_at?e(x):e(T,!1)});var I=r(y,2),A=e=>{var a=z(),s=r(m(a),2),l=m(s);g(e=>L(l,e),[()=>X(p(t).expires_at)]),k(e,a)};v(I,e=>{p(t).expires_at&&e(A)});var P=r(h,2);m(P).__click=()=>async function(e){confirm("Are you sure you want to revoke this token? This cannot be undone.")&&(await $.revokeToken(e)?E.success("Token revoked"):E.error("Failed to revoke token"))}(p(t).id),g(e=>{L(c,p(t).name),L(d,`${p(t).token_prefix??""}...`),L(w,e)},[()=>X(p(t).created_at)]),k(e,a)}),k(e,t)};v(a,e=>{0===o().tokens.length?e(s):e(l,!1)},!0),k(e,t)};v(se,e=>{o().loading&&0===o().tokens.length?e(le):e(oe,!1)});var ce=r(te,2),ne=e=>{var t=S();t.__click=()=>n(U,!1);var a=m(t);a.__click=e=>e.stopPropagation();var s=m(a);r(m(s),2).__click=()=>n(U,!1);var l=r(s,2),o=m(l),c=r(m(o),2),i=r(o,2),v=r(m(i),2),d=m(v),u=m(d);u.__change=()=>Z("read");var h=r(d,2),b=m(h);b.__change=()=>Z("write");var _=r(h,2),x=m(_);x.__change=()=>Z("admin");var T=r(i,2),C=r(m(T),2);g(()=>{p(P),I(()=>{})});var L=m(C);L.value=L.__value="";var E=r(L);E.value=E.__value="30";var $=r(E);$.value=$.__value="60";var M=r($);M.value=M.__value="90";var D=r(M);D.value=D.__value="365";var B=r(l,2),j=m(B);j.__click=()=>n(U,!1);var H=r(j,2);H.__click=K,g((e,t,a,s)=>{f(u,e),f(b,t),f(x,a),H.disabled=s},[()=>p(O).includes("read"),()=>p(O).includes("write"),()=>p(O).includes("admin"),()=>!p(A).trim()]),w(c,()=>p(A),e=>n(A,e)),y(C,()=>p(P),e=>n(P,e)),k(e,t)};v(ce,e=>{p(U)&&e(ne)});var re=r(ce,2),ie=e=>{var t=Y();t.__click=()=>n(W,!1);var a=m(t);a.__click=e=>e.stopPropagation();var s=r(m(a),2),l=r(m(s),2),o=m(l),c=m(o),i=r(o,2);i.__click=Q;var d=m(i),u=e=>{var t=q();k(e,t)},h=e=>{var t=R();k(e,t)};v(d,e=>{p(G)?e(u):e(h,!1)});var b=r(l,2),f=r(m(b),2),w=m(f),y=r(s,2);m(y).__click=()=>n(W,!1),g(()=>{L(c,p(V)),L(w,`rexec login --token "${p(V)??""}"`)}),k(e,t)};v(re,e=>{p(W)&&e(ie)}),k(e,ee),u(),T()}T(["click","change"]);export{O as default};
